---
show: step
version: 1.0 
---
## 课程介绍

本课程将带领您在已经部署 SequoiaDB 巨杉数据库引擎及创建了  SequoiaSQL-MySQL 实例的环境中，学习 SQL 语句的 SELECT 语句。它的用途是从一个或多个表中检索信息。

#### 请点击右侧选择使用的实验环境

#### 部署架构：

本课程中 SequoiaDB 巨杉数据库的集群拓扑结构为三分区单副本，其中包括：1个 SequoiaSQL-MySQL 数据库实例节点、1个引擎协调节点，1个编目节点与3个数据节点。

![图片描述](https://doc.shiyanlou.com/courses/1469/1207281/8d88e6faed223a26fcdc66fa2ef8d3c5)

详细了解 SequoiaDB 巨杉数据库系统架构：

- [SequoiaDB 系统架构](http://doc.sequoiadb.com/cn/sequoiadb-cat_id-1519649201-edition_id-0)

#### 实验环境

课程使用的实验环境为 Ubuntu Linux 16.04 64 位版本。SequoiaDB 数据库引擎以及 SequoiaSQL-MySQL 实例均为 3.4 版本。

#### 概述

MySQL 数据库使用 SQL SELECT 语句来查询数据。本章将介绍到普通查询、WHERE 子句查询、LIMIT、LIKE、ORDER BY、UNION、GROUP BY、JOIN。

## 打开项目

#### 打开idea

打开 idea 代码开发工具

![1735-110-1.png](https://doc.shiyanlou.com/courses/1735/1207281/6f87a8c93937c3c51f6d4839559de710-0)

#### 打开SSQL-MySQL项目

打开 SSQL-MySQL 项目，在该课程中完成后续试验

![1735-110-13.png](https://doc.shiyanlou.com/courses/1735/1207281/40a9e7b6fbd5c3853dc09f69d0a06c86-0)

#### 打开lesson4_query包

打开 lesson4_query packge，在该 packge 中完成后续课程

![1735-140-1.png](https://doc.shiyanlou.com/courses/1735/1207281/2f2774d4225e7b3a50f3ab3e4d74e66f-0)

## 普通查询、使用where子句、limit、like、order by

#### 普通查询

1）打开 QueryTest.java

2）检索表 employee 数据，修改 select 方法的 TODO code 1中代码为

```java
//创建一个 Statement 对象来将 SQL 语句发送到数据库
stmt = conn.createStatement();
//编写 sql 查询 employee 表
String sql = "SELECT * FROM employee";
//执行 sql
rs = stmt.executeQuery(sql);
//遍历查询结果
while (rs.next()) {
    for (int i = 1; i <= rs.getMetaData().getColumnCount() ; i++) {
        System.out.print(rs.getString(i)+"\t");
    }
    System.out.println();
}
```

3）修改参数，右键 SelectTestMain.java，选择 Edit 'SelectTestMain.main()'

![1735-140-2.png](https://doc.shiyanlou.com/courses/1735/1207281/990c7a5be4d21f4005cca31a9eea5a77-0)

4）修改参数为 selectTest



5）执行代码，右键 SelectTestMain.java，选择 Run 'SelectTestMain.main()'，运行代码

![1735-140-4.png](https://doc.shiyanlou.com/courses/1735/1207281/1edc5d3de1f207e14d88a74e8a606ce4-0)

6）查看结果

![1735-140-6.png](https://doc.shiyanlou.com/courses/1735/1207281/dfc064c190a4d5b4da260dd382c63694-0)

#### 使用where子句查询

数据库表一般包含大量的数据，很少需要检索表中所有行。通常只会根据特定操作或报告的需要提取表数据的子集。只检索所需数据需要指定搜索条件，搜索条件也成为过滤条件。

在 SELECT 语句中，数据根据 WHERE 子句中指定的搜索条件进行过滤。WHERE 子句在表名（ FROM 子句）之后给出。

1）打开 QueryTest.java

2）查询 empno 为1的员工信息，修改 selectByWhereTest 方法的 TODO code 2中代码为

```java
//创建一个 Statement 对象来将 SQL 语句发送到数据库
stmt = conn.createStatement();
//编写 sql
String sql = "SELECT * FROM employee WHERE empno = 10001";
//执行 sql
rs = stmt.executeQuery(sql);
//遍历查询结果
while (rs.next()) {
    for (int i = 1; i <= rs.getMetaData().getColumnCount() ; i++) {
        System.out.print(rs.getString(i)+"\t");
    }
    System.out.println();
}
```

3）修改参数，右键 SelectTestMain.java，选择 Edit 'DataTypeMainTest.main()'

4）修改参数为 selectByWhereTest
5）执行代码，右键 SelectTestMain.java，选择 Run 'SelectTestMain.main()'，运行代码
6）查看结果

输出结果为：10001	Georgi	48

#### limit

SELECT 语句返回所有匹配的行，它们可能是指定表中的每个行。为了返回第一行或前几行，可使用 LIMIT 子句。

1）打开 QueryTest.java

2）查询表 employee 的信息，只返回前三行，修改 limitTest 方法的 TODO code 3中代码为

```java
//创建一个 Statement 对象来将 SQL 语句发送到数据库
stmt = conn.createStatement();
//编写 sql
String sql = "SELECT * FROM employee LIMIT 3";
//执行 sql
rs = stmt.executeQuery(sql);
//遍历查询结果
while (rs.next()) {
    for (int i = 1; i <= rs.getMetaData().getColumnCount() ; i++) {
        System.out.print(rs.getString(i)+"\t");
    }
    System.out.println();
}
```

3）修改参数，右键 SelectTestMain.java，选择 Edit 'SelectTestMain.main()'
4）修改参数为 limitTest
5）执行代码，右键 SelectTestMain.java，选择 Run 'SelectTestMain.main()'，运行代码
6）查看结果

​			10001	Georgi	48	
​			10003	Parto	33	
​			10005	Kyoichi	23	

#### like

LIKE 指示 MySQL ,后跟的搜索模式利用通配符匹配而不是直接相等匹配进行比较。

1）打开 QueryTest.java

2）查询 ename 中包含 art 的员工信息，修改 likeTest 方法的 TODO code 4中代码为

```java
//创建一个 Statement 对象来将 SQL 语句发送到数据库
stmt = conn.createStatement();
//编写 sql
String sql = "SELECT * FROM employee WHERE ename LIKE '%art%'";
//执行 sql
rs = stmt.executeQuery(sql);
//遍历查询结果
while (rs.next()) {
    for (int i = 1; i <= rs.getMetaData().getColumnCount() ; i++) {
        System.out.print(rs.getString(i)+"\t");
    }
    System.out.println();
}
```

3）修改参数，右键 SelectTestMain.java，选择 Edit 'SelectTestMain.main()'
4）修改参数为 likeTest
5）执行代码，右键 SelectTestMain.java，选择 Run 'SelectTestMain.main()'，运行代码
6）查看结果

​			10003	Parto	33	

#### order by

为了明确地排序用 SELECT 语句检索出的数据，可使用 ORDER BY 子句。

1）打开 QueryTest.java
2）查询 employee 表信息，并按 empno 倒序展示，修改 orderByTest 方法的 TODO code 5中代码为

```java
//创建一个 Statement 对象来将 SQL 语句发送到数据库
stmt = conn.createStatement();
//编写 sql
String sql = "SELECT * FROM employee ORDER BY empno DESC";
//执行 sql
rs = stmt.executeQuery(sql);
//遍历查询结果
while (rs.next()) {
    for (int i = 1; i <= rs.getMetaData().getColumnCount() ; i++) {
        System.out.print(rs.getString(i)+"\t");
    }
    System.out.println();
}
```

3）修改参数，右键 SelectTestMain.java，选择 Edit 'SelectTestMain.main()'
4）修改参数为 orderByTest
5）执行代码，右键 SelectTestMain.java，选择 Run 'SelectTestMain.main()'，运行代码
6）查看结果

​			10006	Anneke	19	
​			10005	Kyoichi	23	
​			10004	Chirs	40	
​			10003	Parto	33	
​			10002	Bezalel	21	
​			10001	Georgi	48	

## union

多数 SQL 查询都只包含从一个或多个表中返回数据的单条 SELECT 语句。 MySQL 也允许执行多个查询（多条 SELECT 语句），并将结果作为单个查询结果集返回。这些组合查询通常称为并（ union ） 或复合查询
（ compound query ）。

1）打开 QueryTest.java

2）第一条 SELECT 检索 age 大于22的员工信息，第二条 SELECT 检索 empno 为10002的员工信息，修改  likeTest 方法的 TODO code 5中

```java
//创建一个 Statement 对象来将 SQL 语句发送到数据库
stmt = conn.createStatement();
//编写 sql
String sql = "SELECT * FROM employee WHERE age > 22 UNION SELECT * FROM employee WHERE empno = 10002";
//执行 sql
rs = stmt.executeQuery(sql);
//遍历查询结果
while (rs.next()) {
    for (int i = 1; i <= rs.getMetaData().getColumnCount() ; i++) {
        System.out.print(rs.getString(i)+"\t");
    }
    System.out.println();
}
```

3）修改参数，右键 SelectTestMain.java，选择 Edit 'SelectTestMain.main()'
4）修改参数为 unionTest
5）执行代码，右键 SelectTestMain.java，选择 Run 'SelectTestMain.main()'，运行代码
6）查看结果

​			10001	Georgi	48	
​			10003	Parto	33	
​			10005	Kyoichi	23	
​			10004	Chirs	40	
​			10002	Bezalel	21

## group by

GROUP BY 我们可以先从字面上来理解，GROUP 表示分组，BY 后面写字段名，就表示根据哪个字段进行分组，如果有用 Excel 比较多的话，GROUP BY 比较类似 Excel 里面的透视表。
GROUP BY 必须得配合聚合函数来用，分组之后你可以计数（ COUNT ），求和（ SUM ），求平均数（ AVG ）等。

1）打开 QueryTest.java

2）修改 groupByTest 方法的 TODO code 6中代码为

```java
//创建一个 Statement 对象来将 SQL 语句发送到数据库
stmt = conn.createStatement();
//编写 sql
String sql = "SELECT vend_id,COUNT(*) AS num_prods FROM products GROUP BY vend_id";
//执行 sql
rs = stmt.executeQuery(sql);
//遍历查询结果
while (rs.next()) {
    for (int i = 1; i <= rs.getMetaData().getColumnCount() ; i++) {
        System.out.print(rs.getString(i)+"\t");
    }
    System.out.println();
}
```

3）修改参数，右键 SelectTestMain.java，选择 Edit 'SelectTestMain.main()'
4）修改参数为 groupByTest
5）执行代码，右键 SelectTestMain.java，选择 Run 'SelectTestMain.main()'，运行代码
6）查看结果

​			1001	3	
​			1002	2	
​			1003	3		

## join

SQL 最强大的功能之一就是能在数据检索查询的执行中联结（ join ）表。联结是利用 SQL 的 SELECT 能执行的最重要的操作。

join 按照功能大致分为如下三类：

- **INNER JOIN（内连接,或等值连接）**：获取两个表中字段匹配关系的记录。
- **LEFT JOIN（左连接）：**获取左表所有记录，即使右表没有对应匹配的记录。
- **RIGHT JOIN（右连接）：** 与 LEFT JOIN 相反，用于获取右表所有记录，即使左表没有对应匹配的记录。

#### inner join

1）打开 QueryTest.java

2）修改 innerJoinTest 方法的 TODO code 7中代码为

```java
//创建一个 Statement 对象来将 SQL 语句发送到数据库
stmt = conn.createStatement();
//编写 sql
String sql = "SELECT a.runoob_id, a.runoob_author, b.runoob_count FROM info_tbl a INNER JOIN count_tbl b ON a.runoob_author = b.runoob_author";
//执行 sql
rs = stmt.executeQuery(sql);
//遍历查询结果
while (rs.next()) {
    for (int i = 1; i <= rs.getMetaData().getColumnCount() ; i++) {
        System.out.print(rs.getString(i)+"\t");
    }
    System.out.println();
}
```

3）修改参数，右键 SelectTestMain.java，选择 Edit 'SelectTestMain.main()'
4）修改参数为 innerJoinTest
5）执行代码，右键 SelectTestMain.java，选择 Run 'SelectTestMain.main()'，运行代码
6）查看结果

​			1	sequoiadb.com	10	
​			2	sequoiadb.com	10	
​			3	baidu.com	20	
​			4	baidu.com	20	

#### left join

1）打开 QueryTest.java

2）修改 leftJoinTest 方法的 TODO code 8中代码为

```java
//创建一个 Statement 对象来将 SQL 语句发送到数据库
stmt = conn.createStatement();
//编写 sql
String sql = "SELECT a.runoob_id, a.runoob_author, b.runoob_count FROM info_tbl a LEFT JOIN count_tbl b ON a.runoob_author = b.runoob_author;";
//执行 sql
rs = stmt.executeQuery(sql);
//遍历查询结果
while (rs.next()) {
    for (int i = 1; i <= rs.getMetaData().getColumnCount() ; i++) {
        System.out.print(rs.getString(i)+"\t");
    }
    System.out.println();
}
```

3）修改参数，右键 SelectTestMain.java，选择 Edit 'SelectTestMain.main()'
4）修改参数为 leftJoinTest
5）执行代码，右键 SelectTestMain.java，选择 Run 'SelectTestMain.main()'，运行代码
6）查看结果

​			1	sequoiadb.com	10	
​			2	sequoiadb.com	10	
​			3	baidu.com	20	
​			4	baidu.com	20	
​			5	FK	null		

#### right join

1）打开 QueryTest.java

2）修改 rightJoinTest 方法的 TODO code 9中代码为

```java
//创建一个 Statement 对象来将 SQL 语句发送到数据库
stmt = conn.createStatement();
//编写 sql
String sql = "SELECT a.runoob_id, a.runoob_author, b.runoob_count FROM info_tbl a RIGHT JOIN count_tbl b ON a.runoob_author = b.runoob_author;";
//执行 sql
rs = stmt.executeQuery(sql);
//遍历查询结果
while (rs.next()) {
    for (int i = 1; i <= rs.getMetaData().getColumnCount() ; i++) {
        System.out.print(rs.getString(i)+"\t");
    }
    System.out.println();
}
```

3）修改参数，右键 SelectTestMain.java，选择 Edit 'SelectTestMain.main()'
4）修改参数为 rightJoinTest
5）执行代码，右键 SelectTestMain.java，选择 Run 'SelectTestMain.main()'，运行代码
6）查看结果

​			1	sequoiadb.com	10	
​			2	sequoiadb.com	10	
​			3	baidu.com	20	
​			4	baidu.com	20	
​			null	null	22	



