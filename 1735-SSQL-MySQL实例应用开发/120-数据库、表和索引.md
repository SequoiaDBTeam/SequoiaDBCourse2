---
show: step
version: 1.0 

---

## 课程介绍

本课程将带领您在已经部署 SequoiaDB 巨杉数据库引擎及创建了 MySQL 实例的环境中，创建并删除数据库、表和索引

#### 请点击右侧选择使用的实验环境

#### 实验环境

课程使用的实验环境为 Ubuntu Linux 16.04 64 位版本。SequoiaDB 数据库引擎以及 SequoiaSQL-MySQL 实例均为 3.4 版本。

#### 课程概述

**数据库**

数据库，简而言之可视为电子化的文件柜——存储电子文件的处所，用户可以对文件中的数据运行新增、截取、更新、删除等操作。

所谓“数据库”系以一定方式储存在一起、能予多个用户共享、具有尽可能小的冗余度、与应用程序彼此独立的数据集合

**表**

数据表是数据库中主要的数据存储容器，表中的数据被组织成行和列。

**索引**

MySQL索引的建立对于MySQL的高效运行是很重要的，索引可以大大提高MySQL的检索速度。

## 打开项目

#### 打开idea

打开idea代码开发工具

![1735-110-1.png](https://doc.shiyanlou.com/courses/1735/1207281/6f87a8c93937c3c51f6d4839559de710-0)

#### 打开SSQL-MySQL项目

打开SSQL-MySQL项目，在该课程中完成后续试验

![1735-110-13.png](https://doc.shiyanlou.com/courses/1735/1207281/40a9e7b6fbd5c3853dc09f69d0a06c86-0)

#### 打开lesson2_tableAndIndex包

打开lesson2_tableAndIndex packge，在该packge中完成后续课程。

![1735-120-1.png](https://doc.shiyanlou.com/courses/1735/1207281/ee51eb425b9b87d399ebdf5478f7a52b-0)

## 创建和删除数据库

#### 创建数据库

修改DatabaseTest.java的第19行create方法中的TODO

```java
stmt = conn.createStatement();
String sql = "create database employee";
stmt.executeUpdate(sql);
```

![1587290288367](C:\Users\ChengYueyi\AppData\Roaming\Typora\typora-user-images\1587290288367.png)

右键TableAndIndexMainTest.java，选择Edit修改参数为createDatabase，确认后，右键TableAndIndexMainTest.java，选择Run执行创建数据库代码

![1735-120-5.png](https://doc.shiyanlou.com/courses/1735/1207281/e9e14bd292d4abf41c68cb7ee458a1d4-0)

![1587290495569](C:\Users\ChengYueyi\AppData\Roaming\Typora\typora-user-images\1587290495569.png)

![1735-120-7.png](https://doc.shiyanlou.com/courses/1735/1207281/892d8eb39f67e8451f970aad9ce057cb-0)

#### 删除数据库

修改DatabaseTest.java的第12行drop方法中的TODO

```java
stmt = conn.createStatement();
String sql = "drop database employee";
stmt.executeUpdate(sql);
```

![1587290771845](C:\Users\ChengYueyi\AppData\Roaming\Typora\typora-user-images\1587290771845.png)

右键TableAndIndexMainTest.java，选择Edit修改参数为dropDatabase，确认后，右键TableAndIndexMainTest.java，选择Run执行创建数据库代码

![1735-120-7.png](https://doc.shiyanlou.com/courses/1735/1207281/892d8eb39f67e8451f970aad9ce057cb-0)

## 创建普通表、hash表

#### 创建sdb普通表employee

修改TableTest.java的第17行createTable方法中的TODO

```java
stmt = conn.createStatement();
String sql = "CREATE TABLE employee " +
    "(" +
    "empno INT AUTO_INCREMENT PRIMARY KEY, " +
    "ename VARCHAR(128), " +
    "age INT" +
    ")";
stmt.executeUpdate(sql);
```

右键TableAndIndexMainTest.java，修改参数为createTable，选择Run执行创建普通表employee

![1735-120-7.png](https://doc.shiyanlou.com/courses/1735/1207281/892d8eb39f67e8451f970aad9ce057cb-0)

#### 创建hash表

也称为散列表 由直接寻址表改进而来.先看直接寻址表 当关键字的全域U比较小时，直接寻址是一种简单而有效的技术。加入某应用要用到一个动态集合，其中每个元素都有一个取自全域U={0,1,...,m-1}的关键字。同时假设没有两个元素具有相同的关键字。

修改TableTest.java的第11行createHashTable方法中的TODO

```java
stmt = conn.createStatement();
String sql = "CREATE TABLE employee " +
    "(" +
    "empno INT AUTO_INCREMENT PRIMARY KEY, " +
    "ename VARCHAR(128), " +
    "age INT" +
    ")COMMENT=\"sequoiadb:{table_options:{ShardingKey:{ empno: 1 }, ShardingType: " +
    "'hash', Partition: 4096, ReplSize: 1 } }\"";
stmt.executeUpdate(sql);
```

> `ShardingKey` ( *Object* )：分区键。
>
> `ShardingType` ( *String* )：分区方式。
>
> `Partition` ( *Int32* )：分区数。仅当选择 hash 分区时填写，代表了 hash 分区的个数。其值必须是2的幂。范围在[2^3，2^20]。默认为4096。
>
> `ReplSize` ( *Int32* )：写操作需同步的副本数。默认值为1。其可选取值如下：
>
> - -1：表示写请求需同步到该复制组若干活跃的节点之后，数据库写操作才返回应答给客户端。
> - 0：表示写请求需同步到该复制组的所有节点之后，数据库写操作才返回应答给客户端。
> - 1 - 7：表示写请求需同步到该复制组指定数量个节点之后，数据库写操作才返回应答给客户端。

![1587291201170](C:\Users\ChengYueyi\AppData\Roaming\Typora\typora-user-images\1587291201170.png)

右键TableAndIndexMainTest.java，选择Edit修改参数为createHashTable，确认后，右键TableAndIndexMainTest.java，选择Run执行创建hash表代码

![1735-120-5.png](https://doc.shiyanlou.com/courses/1735/1207281/e9e14bd292d4abf41c68cb7ee458a1d4-0)

![1735-120-7.png](https://doc.shiyanlou.com/courses/1735/1207281/892d8eb39f67e8451f970aad9ce057cb-0)

## 创建/删除普通索引、唯一索引、复合索引

#### 创建普通索引

普通索引：最基本的索引，它没有任何限制，用于加速查询。

修改IndexTest.java的第27行的createIndex方法的TODO

```java
stmt = conn.createStatement();
String sql = "alter table employee_idx add index(ename)";
stmt.executeUpdate(sql);
```

右键TableAndIndexMainTest.java，选择Edit修改参数为createIndex，确认后，右键TableAndIndexMainTest.java，选择Run执行

![1735-120-5.png](https://doc.shiyanlou.com/courses/1735/1207281/e9e14bd292d4abf41c68cb7ee458a1d4-0)

![1735-120-7.png](https://doc.shiyanlou.com/courses/1735/1207281/892d8eb39f67e8451f970aad9ce057cb-0)

查看结果

![1735-120-14.png](https://doc.shiyanlou.com/courses/1735/1207281/4ade9392deab5a85972fd0d93cde71c1-0)

#### 创建唯一索引

唯一索引：索引列的值必须唯一，但允许有空值。如果是组合索引，则列值的组合必须唯一。

修改IndexTest.java的第21行的createUniqueIndex方法的TODO

```java
stmt = conn.createStatement();
String sql = "alter table employee_idx add unique index(empno)";
stmt.executeUpdate(sql);
```

右键TableAndIndexMainTest.java，选择Edit修改参数为createUniqueIndex，确认后，右键TableAndIndexMainTest.java，选择Run执行创建唯一索引

![1735-120-5.png](https://doc.shiyanlou.com/courses/1735/1207281/e9e14bd292d4abf41c68cb7ee458a1d4-0)

![1735-120-7.png](https://doc.shiyanlou.com/courses/1735/1207281/892d8eb39f67e8451f970aad9ce057cb-0)

查看结果

employee_idx	0	empno	1	empno	A	null	null	null	YES	BTREE	

#### 创建复合索引

复合索引：指多个字段上创建的索引，只有在查询条件中使用了创建索引时的第一个字段，索引才会被使用。使用组合索引时遵循最左前缀集合。

修改IndexTest.java的第14行的createCompositeIndex方法的TODO

```java
stmt = conn.createStatement();
String sql = "alter table employee_idx add unique index(ename,age)";
stmt.executeUpdate(sql);
```

右键TableAndIndexMainTest.java，选择Edit修改参数为createCompositeIndex，确认后，右键TableAndIndexMainTest.java，选择Run执行创建复合索引

![1735-120-5.png](https://doc.shiyanlou.com/courses/1735/1207281/e9e14bd292d4abf41c68cb7ee458a1d4-0)

![1735-120-7.png](https://doc.shiyanlou.com/courses/1735/1207281/892d8eb39f67e8451f970aad9ce057cb-0)

查看结果

employee_idx	0	ename	1	ename	A	null	null	null	YES	BTREE		
employee_idx	0	ename	2	age	A	null	null	null	YES	BTREE	

## 删除索引

删除表employee的复合索引ename

修改IndexTest.java的第11行的dropIndex方法的TODO

```java
stmt = conn.createStatement();
String sql = "alter table employee_idx drop index ename";
stmt.executeUpdate(sql);
```

右键TableAndIndexMainTest.java，选择Edit修改参数为dropIndex，确认后，右键TableAndIndexMainTest.java，选择Run执行删除复合索引

![1735-120-5.png](https://doc.shiyanlou.com/courses/1735/1207281/e9e14bd292d4abf41c68cb7ee458a1d4-0)

![1735-120-7.png](https://doc.shiyanlou.com/courses/1735/1207281/892d8eb39f67e8451f970aad9ce057cb-0)

## 创建、删除单列主键

“主键（PRIMARY KEY）”的完整称呼是“主键约束”。MySQL主键约束是一个列或者列的组合，其值能唯一地标识表中的每一行。这样的一列或多列称为表的主键，通过它可以强制表的实体完整性。

#### 创建单列主键

修改UpdateTest.java的第8行

```java
stmt = conn.createStatement();
String sql = "alter table employee_pk add primary key(empno)";
stmt.executeUpdate(sql);
```

右键TableAndIndexMainTest.java，选择Edit修改参数为createPK，确认后，右键TableAndIndexMainTest.java，选择Run执行创建单列主键

![1735-120-5.png](https://doc.shiyanlou.com/courses/1735/1207281/e9e14bd292d4abf41c68cb7ee458a1d4-0)

![1735-120-7.png](https://doc.shiyanlou.com/courses/1735/1207281/892d8eb39f67e8451f970aad9ce057cb-0)

查看结果

![1735-120-22.png](https://doc.shiyanlou.com/courses/1735/1207281/25068d95d7ac6f57339c40ede8d59224-0)

#### 删除单列主键

修改UpdateTest.java的第8行

```java
stmt = conn.createStatement();
String sql = "alter table employee_pk drop primary key";
stmt.executeUpdate(sql);
```

右键TableAndIndexMainTest.java，选择Edit修改参数为dropPK，确认后，右键TableAndIndexMainTest.java，选择Run执行删除单列主键

![1735-120-5.png](https://doc.shiyanlou.com/courses/1735/1207281/e9e14bd292d4abf41c68cb7ee458a1d4-0)

![1735-120-7.png](https://doc.shiyanlou.com/courses/1735/1207281/892d8eb39f67e8451f970aad9ce057cb-0)

查看结果

![1735-120-24.png](https://doc.shiyanlou.com/courses/1735/1207281/661073e1cee9b8d88a920382ec232546-0)
