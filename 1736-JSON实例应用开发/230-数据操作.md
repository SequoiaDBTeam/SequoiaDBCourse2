---
show: step
version: 1.0

---

## 课程介绍

本课程将介绍在 Java 开发环境下如何对 SequoiaDB 数据库 JSON 实例中的集合，进行数据的查询、插入、修改和删除等操作。

#### JSON 开发简介

SequoiaDB 巨杉数据库为应用提供通过 SDK 驱动进行数据库操作和集群操作的接口。

#### 实验流程简述

- 用户通过 IDEA 编辑器编写 Java 源码
- 实验相关核心代码，可从文档中的代码示例粘贴到项目指定文件的 TODO 标记处
- 通过编译、运行 Java 代码，操作 SequoiaDB 数据库 JSON 实例

![](https://doc.shiyanlou.com/courses/1736/1207281/7b1731fc121e3b460dcd9841eb0218a6-0)

#### 实验环境

课程使用的实验环境为 Ubuntu Linux 16.04 64 位版本。SequoiaDB 数据库引擎为 3.4 版本。IDEA 编辑器为 16.0 版本。JDK 为 1.8 版本。

## 打开项目

#### 打开 IDEA

打开 IDEA 代码开发工具。

![](https://doc.shiyanlou.com/courses/1736/1207281/06650396616c742995bb63fcf933fac5-0)

#### 打开项目

打开指定项目，在该项目中完成所有实验步骤。

![](https://doc.shiyanlou.com/courses/1736/1207281/9f17386c8098e8f4e46634f208fcd36b-0)

#### 打开 Package

打开指定的 Package，在该 Package 中完成后续课程。

![](https://doc.shiyanlou.com/courses/1736/1207281/fe6a1ec2f1298f67b6eda21bcebf8bad-0)

## 单条插入 JSON 格式字符串

#### 概述

通过构造 JSON 格式的字符串插入数据

#### 操作步骤

打开指定的 Java 源文件。

![](https://doc.shiyanlou.com/courses/1736/1207281/321262ee0aa7de1129109be95de0cd06-0)

复制以下代码样例。

```java
// 向集合内插入1条数据,数据为JSON格式
cl.insert("{ \"empno\": 10001, \"ename\": \"Georgi\", \"age\": 48}}");
```

将代码样例粘贴到第 63 行的 TODO ~ TODO END 位置区间内。

![// TODO 贴图](https://doc.shiyanlou.com/courses/1736/1207281/4f2b9e0b7a52aa2058a4322e1f26c6bd-0)

右键点击 CRUDMainTest类，创建/编辑主类运行环境。

![](https://doc.shiyanlou.com/courses/1736/1207281/a25350cc9ac72d4142adaf9a9736159a-0)

配置 Configuration 页中的 Program arguments 选项，写入指定的参数，点击”OK“。

![// TODO 贴图](https://doc.shiyanlou.com/courses/1736/1207281/8be8f4ccdddb931c591d36f5d505d40b-0) 

右键点击 CRUDMainTest类，运行主程序。

![](https://doc.shiyanlou.com/courses/1736/1207281/5000e9adc5a84c6a875e4de7cf0c2729-0)

在 IDEA 输出窗口查看运行效果。

![// TODO 贴图](https://doc.shiyanlou.com/courses/1736/1207281/e505b8c8257ea353a249e825ece2ea2d-0)

双击放大控制台输出窗口，查看详细输出信息。

![](https://doc.shiyanlou.com/courses/1736/1207281/112c92cf1320077f0543324edd47c33b-0)

通过输出信息，可以看到成功获取了数据组的详细信息，证明了数据库的连通性。

## 单条插入BsonObject 对象

#### 概述

通过构造一个 BsonObject 对象进行插入。

#### 操作步骤

打开指定的 Java 源文件。

![](https://doc.shiyanlou.com/courses/1736/1207281/321262ee0aa7de1129109be95de0cd06-0)

复制以下代码样例。

```java
// 向集合内插入1条数据，数据为BsonObject对象
BSONObject record = new BasicBSONObject();
record.put("empno", 10002);
record.put("ename", "Bezalel");
record.put("age", 31);
cl.insert(record);
```

将代码样例粘贴到第 46 行的 TODO ~ TODO END 位置区间内。

![// TODO 贴图](https://doc.shiyanlou.com/courses/1736/1207281/367d881c50caffd1050c442161749db0-0)

右键点击 CRUDMainTest类，创建/编辑主类运行环境。

![](https://doc.shiyanlou.com/courses/1736/1207281/a25350cc9ac72d4142adaf9a9736159a-0)

配置 Configuration 页中的 Program arguments 选项，写入指定的参数，点击”OK“。

![// TODO 贴图](https://doc.shiyanlou.com/courses/1736/1207281/14e9200059168f0e077965918a61d7a2-0) 

右键点击 CRUDMainTest类，运行主程序。

![](https://doc.shiyanlou.com/courses/1736/1207281/5000e9adc5a84c6a875e4de7cf0c2729-0)

在 IDEA 输出窗口查看运行效果。

![// TODO 贴图](https://doc.shiyanlou.com/courses/1736/1207281/e505b8c8257ea353a249e825ece2ea2d-0)

双击放大控制台输出窗口，查看详细输出信息。

![](https://doc.shiyanlou.com/courses/1736/1207281/e703e7b78e56e818d1041ce3a50bb889-0)

通过输出信息，可以看到通过 BsonObject 对象，成功插入了一条数据。

## 批量插入 BsonObject 对象

#### 概述

通过构造一个 BsonObject 的集合

#### 操作步骤

打开指定的 Java 源文件。

![](https://doc.shiyanlou.com/courses/1736/1207281/321262ee0aa7de1129109be95de0cd06-0)

复制以下代码样例。

```java
// 向集合内插入多条数据
List<BSONObject> records = new ArrayList<>();
BasicBSONObject r1 = new BasicBSONObject();
r1.put("empno", 10003);
r1.put("ename", "Parto");
r1.put("age", 33);
records.add(r1);
BasicBSONObject r2 = new BasicBSONObject();
r2.put("empno", 10004);
r2.put("ename", "Chirstian");
r2.put("age", 18);
records.add(r2);
cl.insert(records);
```

将代码样例粘贴到第 29 行的 TODO ~ TODO END 位置区间内。

![// TODO 贴图](https://doc.shiyanlou.com/courses/1736/1207281/c0563202831d178cbe8923dda53302d9-0)

右键点击 CRUDMainTest类，创建/编辑主类运行环境。

![](https://doc.shiyanlou.com/courses/1736/1207281/a25350cc9ac72d4142adaf9a9736159a-0)

配置 Configuration 页中的 Program arguments 选项，写入指定的参数，点击”OK“。

![// TODO 贴图](https://doc.shiyanlou.com/courses/1736/1207281/c7cb160da4d97287f687bc7e74bc6a28-0) 

右键点击 CRUDMainTest类，运行主程序。

![](https://doc.shiyanlou.com/courses/1736/1207281/5000e9adc5a84c6a875e4de7cf0c2729-0)

在 IDEA 输出窗口查看运行效果。

![// TODO 贴图](https://doc.shiyanlou.com/courses/1736/1207281/e505b8c8257ea353a249e825ece2ea2d-0)

双击放大控制台输出窗口，查看详细输出信息。

![](https://doc.shiyanlou.com/courses/1736/1207281/bcc72a525563f361752cb231cd7d2cff-0)

通过输出信息，可以看到成功批量插入了两条数据。

## 查询指定集合下的所有数据

#### 概述

查询集合下所有数据时，query 方法不用传入过滤参数

#### 操作步骤

打开指定的 Java 源文件。

![](https://doc.shiyanlou.com/courses/1736/1207281/0bcea2f5bf6e6414de35c648d3f421c3-0)

复制以下代码样例。

```java
cursor = cl.query();
```

将代码样例粘贴到第 35 行的 TODO ~ TODO END 位置区间内。

![// TODO 贴图](https://doc.shiyanlou.com/courses/1736/1207281/13fb1fadf000586df4b1c3d3e5d0d478-0)

右键点击 CRUDMainTest 类，创建/编辑主类运行环境。

![](https://doc.shiyanlou.com/courses/1736/1207281/a25350cc9ac72d4142adaf9a9736159a-0)

配置 Configuration 页中的 Program arguments 选项，写入指定的参数，点击”OK“。

![// TODO 贴图](https://doc.shiyanlou.com/courses/1736/1207281/809525b5649b01e4ac085dd9bcbb9652-0) 

右键点击 CRUDMainTest类，运行主程序。

![](https://doc.shiyanlou.com/courses/1736/1207281/5000e9adc5a84c6a875e4de7cf0c2729-0)

在 IDEA 输出窗口查看运行效果。

![// TODO 贴图](https://doc.shiyanlou.com/courses/1736/1207281/e505b8c8257ea353a249e825ece2ea2d-0)

双击放大控制台输出窗口，查看详细输出信息。

![](https://doc.shiyanlou.com/courses/1736/1207281/66602c2d697dbb524f34f171fc69d066-0)

通过输出信息，可以看到集合内包含 5 条数据。

## 查询指定集合下符合条件的数据

#### 概述

通过添加过滤条件进行过滤查询。

#### 操作步骤

打开指定的 Java 源文件。

![](https://doc.shiyanlou.com/courses/1736/1207281/0bcea2f5bf6e6414de35c648d3f421c3-0)

复制以下代码样例。

```java
BSONObject matcher = new BasicBSONObject();
// $et表示等于
BSONObject et = new BasicBSONObject();
et.put("$et", 19);
// 年龄等于19
matcher.put("age", et);
cursor = cl.query(matcher, null, null, null);
```

将代码样例粘贴到第 22 行的 TODO ~ TODO END 位置区间内。

![// TODO 贴图](https://doc.shiyanlou.com/courses/1736/1207281/320bd0cc333cbe2b47cc776593ea3492-0)

右键点击 CRUDMainTest类，创建/编辑主类运行环境。

![](https://doc.shiyanlou.com/courses/1736/1207281/a25350cc9ac72d4142adaf9a9736159a-0)

配置 Configuration 页中的 Program arguments 选项，写入指定的参数，点击”OK“。

![// TODO 贴图](https://doc.shiyanlou.com/courses/1736/1207281/1c9b37c3e65dae7c00f76def3262821a-0) 

右键点击 CRUDMainTest类，运行主程序。

![](https://doc.shiyanlou.com/courses/1736/1207281/5000e9adc5a84c6a875e4de7cf0c2729-0)

在 IDEA 输出窗口查看运行效果。

![// TODO 贴图](https://doc.shiyanlou.com/courses/1736/1207281/e505b8c8257ea353a249e825ece2ea2d-0)

双击放大控制台输出窗口，查看详细输出信息。

![](https://doc.shiyanlou.com/courses/1736/1207281/65bdb70e4036f687d948d7feebbbb669-0)

通过输出信息，可以看到通过条件过滤成功查询到了指定数据。

## 更新指定数据

#### 概述

通过匹配符更新指定的数据。

#### 操作步骤

打开指定的 Java 源文件。

![](https://doc.shiyanlou.com/courses/1736/1207281/6afc9df23de3638edc8dcb4460804b12-0)

复制以下代码样例。

```java
// 设置匹配规则，$et代表等于值
BSONObject matcher = new BasicBSONObject();
BSONObject et = new BasicBSONObject();
et.put("$et", 19);
matcher.put("age", et);
// 设置修改后的值
BSONObject modifier = new BasicBSONObject();
BSONObject value = new BasicBSONObject();
value.put("age", 20);
modifier.put("$set", value);
// 执行update操作
cl.update(matcher, modifier, null);
```

将代码样例粘贴到第 22 行的 TODO ~ TODO END 位置区间内。

![// TODO 贴图](https://doc.shiyanlou.com/courses/1736/1207281/c0e32e0fce4274a2c37eac4a26d94458-0)

右键点击 CRUDMainTest 类，创建/编辑主类运行环境。

![](https://doc.shiyanlou.com/courses/1736/1207281/a25350cc9ac72d4142adaf9a9736159a-0)

配置 Configuration 页中的 Program arguments 选项，写入指定的参数，点击”OK“。

![// TODO 贴图](https://doc.shiyanlou.com/courses/1736/1207281/59f609383c04e5da881aa643c1a1ecb5-0) 

右键点击 CRUDMainTest类，运行主程序。

![](https://doc.shiyanlou.com/courses/1736/1207281/5000e9adc5a84c6a875e4de7cf0c2729-0)

在 IDEA 输出窗口查看运行效果。

![// TODO 贴图](https://doc.shiyanlou.com/courses/1736/1207281/e505b8c8257ea353a249e825ece2ea2d-0)

双击放大控制台输出窗口，查看详细输出信息。

![](https://doc.shiyanlou.com/courses/1736/1207281/8e2898a67511782d767e5f7625ac9b71-0)

通过输出信息，可以看到成功将年龄更新为 20。

## 删除数据

#### 概述

通过匹配符删除指定数据。

#### 操作步骤

打开指定的 Java 源文件。

![](https://doc.shiyanlou.com/courses/1736/1207281/7f2bb4c9748c340956249e9e54519cf3-0)

复制以下代码样例。

```java
// 设置匹配规则，$et代表等于值
BSONObject matcher = new BasicBSONObject();
BSONObject et = new BasicBSONObject();
et.put("$et", 19);
matcher.put("age", et);
// 执行delete操作
cl.delete(matcher);
```

将代码样例粘贴到第 22 行的 TODO ~ TODO END 位置区间内。

![// TODO 贴图](https://doc.shiyanlou.com/courses/1736/1207281/1419511b56c7b6d66825e191ab334cda-0)

右键点击 CRUDMainTest 类，创建/编辑主类运行环境。

![](https://doc.shiyanlou.com/courses/1736/1207281/a25350cc9ac72d4142adaf9a9736159a-0)

配置 Configuration 页中的 Program arguments 选项，写入指定的参数，点击”OK“。

![// TODO 贴图](https://doc.shiyanlou.com/courses/1736/1207281/9643528593fceec3fd62d6b139595f7a-0) 

右键点击 CRUDMainTest类，运行主程序。

![](https://doc.shiyanlou.com/courses/1736/1207281/5000e9adc5a84c6a875e4de7cf0c2729-0)

在 IDEA 输出窗口查看运行效果。

![// TODO 贴图](https://doc.shiyanlou.com/courses/1736/1207281/e505b8c8257ea353a249e825ece2ea2d-0)

双击放大控制台输出窗口，查看详细输出信息。

可以看到，集合中原有数据 5 条。

![](https://doc.shiyanlou.com/courses/1736/1207281/c1c748c6c0ea8195cf0d6c78eb305b98-0)

删除后，age 为 19 的数据已经不在了，集合内设于 4 条数据。

![](https://doc.shiyanlou.com/courses/1736/1207281/7a96471f22b1b524a1591e997e6a4420-0)

## 总结

本课程介绍了 Java 开发环境下如何对 SequoiaDB 数据库 JSON 实例中的集合，进行数据的查询、插入、修改和删除等操作。
